!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).SpPageEditor=t()}(this,function(){"use strict";var e=function(e,t,a,i,s,n,r,o,p,l){"boolean"!=typeof r&&(p=o,o=r,r=!1);var g,u="function"==typeof a?a.options:a;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,s&&(u.functional=!0)),i&&(u._scopeId=i),n?(g=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,p(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},u._ssrRegister=g):t&&(g=r?function(){t.call(this,l(this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),g)if(u.functional){var d=u.render;u.render=function(e,t){return g.call(t),d(e,t)}}else{var c=u.beforeCreate;u.beforeCreate=c?[].concat(c,g):[g]}return a};const t={mounted:function(){this.updatePageSettings()},watch:{"$route.query.page":function(){this.updatePageSettings()}},data:function(){return{pageSettings:{path:"",label:"",layout:"",roles:[],isTopLevel:!0,folder:null},errors:{},pageForm:{fields:[{name:"path",label:"msg_path",type:"text",required:!0,customValidator:this.validatePath},{name:"label",label:"msg_label",type:"text",required:!0},{name:"layout",label:"msg_layout",type:"select",options:this.$app.adminData.pageLayouts.layoutList,required:!0},{name:"roles",label:"msg_access_roles",type:"select",multiple:!0,options:this.$app.constants.ROLES},{name:"isTopLevel",label:"msg_top_level",type:"checkbox"}]}}},computed:{pageTitle:function(){return this.$route.query.page?this.$i18n("msg_edit_page_metadata"):this.$i18n("msg_create_new_page")},pageAction:function(){return this.$route.query.page?"msg_save_metadata":"msg_create_page"}},methods:{validatePath:function(e,t){if(this.$app.getPage(t)){if(t!=this.$route.query.page)return"error_duplicate_page_path"}else if(!/^[a-z0-9]+$/i.test(t))return"error_invalid_page_path";return null},cancelEdit:function(){this.$router.back()},savePage:function(){this.$route.query.page?this.$app.editPage(this.$route.query.page,this.pageSettings):this.$app.createPage(this.pageSettings)},updatePageSettings:function(){if(this.$route.query.page){var e=this.$app.getPage(this.$route.query.page);this.pageSettings.path=e.path,this.pageSettings.label=e.label,this.pageSettings.layout=e.layout,this.pageSettings.roles=e.roles,this.pageSettings.isTopLevel=e.isTopLevel,this.pageSettings.folder=e.folder,this.pageSettings.roles||(this.pageSettings.roles=[])}else this.pageSettings.path="",this.pageSettings.label="",this.pageSettings.layout="",this.pageSettings.roles=[],this.pageSettings.isTopLevel=!0,this.pageSettings.folder=null,this.pageSettings.roles=[]}}};var a=function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"sp-one-column-container"},[t("div",{staticClass:"card sp-card p-1 p-sm-5 mt-3"},[t("sp-form",{attrs:{"form-def":this.pageForm,"data-object":this.pageSettings,errors:this.errors,"form-id":"pageEditorForm","save-label":this.pageAction,"save-callback":this.savePage,"cancel-callback":this.cancelEdit}})],1)])};a._withStripped=!0;return e({render:a,staticRenderFns:[]},void 0,t,void 0,!1,void 0,void 0,void 0)});
